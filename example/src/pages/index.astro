---
import { LikeButton } from '../components/LikeButton';
import { NewsletterForm } from '../components/NewsletterForm';
import { ViewTransitions } from 'astro:transitions';

import { users, likes } from '../lib/fake-db';
import { actions } from 'astro:actions';

const newsletter = Astro.getActionResult(actions.newsletter);
---

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <title>Solid Astro Actions</title>
        <ViewTransitions />
        <style is:global>
            button:disabled {
                opacity: 50%;
            }
        </style>
    </head>
    <body class="mx-auto max-w-2xl py-12 text-center sm:py-16 lg:py-20">
        <h1
            class="flex flex-row items-center gap-4 pb-12 text-4xl font-bold tracking-tight text-gray-900 sm:text-6xl"
        >
            Solid Astro Actions
            <img class="h-12" src="https://www.solidjs.com/img/logo/without-wordmark/logo.svg" />
            +
            <img class="h-12" src="https://astro.build/assets/press/astro-icon-dark.svg" />
        </h1>
        <ul class="pb-12 text-left">
            {
                users.map(user => (
                    <li>
                        <LikeButton postId={user} initialLikes={likes[user]} client:load />
                    </li>
                ))
            }
        </ul>
        <NewsletterForm client:load showSuccessBanner={!!newsletter?.data} />
    </body>
</html>
